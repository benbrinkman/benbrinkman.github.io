<!DOCTYPE html>
<html>
    <head>
        <title>Ben's Miniatures</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="minis.css"> 

    </head>
    <body>
        <div id="top">
<!--
            <input type="text" id="urlInput" name="urlInput">
            <input type="submit" id="inputSubmit" name="inputSubmit" onclick='InputNewMini()'>
-->
        </div>
        <div id="content">
            
<!--
            <div class="content-box">
                <div class="content-box-inside">
                    <div class="name-box">test</div>
                    <div class="info-box-left"></div>
                    <div class="info-box-right"></div>
                    <div class="picture-box">
                        <img src="https://media.miniaturemarket.com/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/d/d/dderlw-025a.jpg">
                    </div>
                    <div class="bottom-box">
                        <img src = "img/dd.png">
                        <div>text</div>
                    </div>
                    
                </div>
            </div>
            
            <div class="content-box">
                <div class="content-box-inside">
                    <div class="name-box"></div>
                    <div class="info-box-left"></div>
                    <div class="info-box-right"></div>
                    <div class="picture-box">
                        <img src="">
                    </div>
                    <div class="bottom-box"></div>
                </div>
            </div>
            
-->
            
        </div>
         

        <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-analytics.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-database.js"></script>



        
        <script>
           
            const firebaseConfig = {
                apiKey: "AIzaSyASmU4cMjsC5zGQzAXtUAxO0U-KSYG2EcE",
                authDomain: "miniatures-8d2a2.firebaseapp.com",
                databaseURL: "https://miniatures-8d2a2-default-rtdb.firebaseio.com",
                projectId: "miniatures-8d2a2",
                storageBucket: "miniatures-8d2a2.appspot.com",
                messagingSenderId: "81733865892",
                appId: "1:81733865892:web:bb89f8059f579523387131",
                measurementId: "G-JN71DH32ZE"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            firebase.analytics();
            var database = firebase.database();
            
            function snapshotToArray(snapshot) {
                var returnArr = [];
                snapshot.forEach(function(childSnapshot) {
                    var item = childSnapshot.val();
                    item.key = childSnapshot.key;
                    returnArr.push(item);
                });
                return returnArr;
            };
            
            
            numDifMinis = 0;
            
            function InputNewMini(name, img_url, size, rarity, source, quantity, sourceLong, game, year, idNum, index){
                
                var contentMain = document.getElementById("content");
                var contentBox = document.createElement('div');
                contentBox.classList.add('content-box');
                
                //Create inner box for tile
                var contentBoxInside= document.createElement('div');
                contentBoxInside.classList.add('content-box-inside');
                contentBox.appendChild(contentBoxInside);
                
                //Create the top element in the box
                var nameBox= document.createElement('div');
                nameBox.classList.add('name-box');
                nameBox.innerHTML=name;
                contentBoxInside.appendChild(nameBox);

                //Create box for SIZE and QUANTITY
                var infoBoxLeft= document.createElement('div');
                infoBoxLeft.classList.add('info-box-left');
                infoBoxLeft.innerHTML="<b>Size:</b> " +size+"<br><b>Quantity:</b> " +quantity;
                infoBoxLeft.title=sourceLong
                contentBoxInside.appendChild(infoBoxLeft);
                
                //Create box for RARITY and SOURCE
                var infoBoxRight = document.createElement('div');
                infoBoxRight.classList.add('info-box-right');
                infoBoxRight.innerHTML="<b>Rarity:</b> "+rarity+"<br><p title='"+sourceLong+"'>"+"<b>Src: </b>"+source+"</p>";
                contentBoxInside.appendChild(infoBoxRight);
                
                //Create the picture holder elements
                var pictureBox = document.createElement('div');
                pictureBox.classList.add('picture-box');
                
                var pictureBoxInner = document.createElement('div');
                pictureBoxInner.classList.add('picture-box-inner');
                
                var pictureLink = document.createElement('a');
                pictureLink.classList.add('picture-link');
                
                if(img_url != "-"){

                    img = new Image();
                    img.src = img_url;
                    img.id = index + source + idNum;
                    pictureLink.appendChild(img);
                    pictureLink.setAttribute("href", img_url);
                }
                
                pictureBoxInner.appendChild(pictureLink);
                pictureBox.appendChild(pictureBoxInner);
                
                contentBoxInside.appendChild(pictureBox);
                                
                var bottomBox = document.createElement('div');
                bottomBox.classList.add('bottom-box');
                bottomBox.innerHTML= game + " " + year;
                contentBoxInside.appendChild(bottomBox);              
                
                contentMain.appendChild(contentBox);
            }
            
            var AccessDatabase = firebase.database().ref('/').once('value').then(function(snapshot) {
                miniatures = snapshotToArray(snapshot);
                var len = miniatures.length;
                console.log(len);
                console.log(miniatures[1].sourceLong);
                function InitDatabase(){
                    for (var i = 0; i < len; i++){
                        if(miniatures[i].imgURL !== "-"){
                            InputNewMini(miniatures[i].name, miniatures[i].imgURL, miniatures[i].size, miniatures[i].rarity, miniatures[i].source, miniatures[i].quantity, miniatures[i].sourceLong, miniatures[i].game,  miniatures[i].year, miniatures[i].index, i)
                        }
                        testWidth = document.getElementById(i+ miniatures[i].source+ miniatures[i].index);
                        if(testWidth != null){
                            if(testWidth.width < testWidth.height){
                                testWidth.classList.add("tallImg");
                            }
                            else{
                                testWidth.classList.add("wideImg");
                            }
                        }
                    }
                }
                InitDatabase();
            
            });
            
            
            
            
        </script>
    </body>
</html>
